<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADD NEW CANDIDATE</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        input[type="text"], input[type="date"], textarea, select {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            box-sizing: border-box;
        }
        button {
            margin-top: 10px;
            padding: 8px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button[type="reset"] {
            background-color: #f44336;
        }
        ol {
            padding-left: 20px;
        }
        li button {
            margin-left: 10px;
            padding: 2px 5px;
            font-size: 12px;
            background-color: #ff9800;
        }
    </style>
</head>
<body>
    <h1>ADD NEW CANDIDATE</h1>
    <form id="candidateForm" onsubmit="submitForm(event)">
        
        <div>
            <label for="Fname">FIRST NAME</label>
            <input type="text" id="Fname" name="FirstName" required placeholder="Gem Adrian">
            
            <label for="Mname">MIDDLE NAME</label>
            <input type="text" id="Mname" name="MiddleName" placeholder="Casimero">
            
            <label for="Lname">LAST NAME</label>
            <input type="text" id="Lname" name="LastName" required placeholder="Candaganan">
        </div>

        <br>

        <section>
            <div id="addressSection">
                <label for="region">REGION</label>
                <select id="region" name="region" required>
                    <option value="" disabled selected>Select Region</option>
                </select>
        
                <br><br>
        
                <label for="province">PROVINCE</label>
                <select id="province" name="province" required>
                    <option value="" disabled selected>Select Province</option>
                </select>
        
                <br><br>
        
                <label for="city">CITY/MUNICIPALITY</label>
                <select id="city" name="city" required>
                    <option value="" disabled selected>Select City/Municipality</option>
                </select>
            </div>
        </section>

        <br>
        
        <div>
            <label for="biography">SHORT BIOGRAPHY</label>  
            <textarea id="biography" name="biography" placeholder="Write the candidate's short biography here"></textarea>
        </div>

        <br>

        <div>
            <label for="bday">BIRTHDAY</label>
            <input type="date" id="bday" name="bday" required>
        </div>
        
        <br>

        <div>
            <label for="Party">POLITICAL PARTY</label>
            <input type="text" id="Party" name="Party">
        </div>

        <br>

        <section>
            <div id="educationalBackgroundSection">
                <label for="education">EDUCATIONAL BACKGROUND</label>  
                <input type="text" id="education" placeholder="Enter Educational Background">
                <button type="button" id="addEducation">ADD EDUCATION</button>

                <p>Listed Educational Background</p>
                <ol id="educationList"></ol>
            </div>
        </section>
        
        <br>
        
        <section>
            <div id="leadershipExperienceSection">
                <label for="experience">LEADERSHIP EXPERIENCE</label>
                <input type="text" id="experience" placeholder="Enter Leadership Experience">
                <button type="button" id="addExperience">ADD EXPERIENCES</button>
                
                <p>Listed Leadership Experience</p>
                <ol id="experienceList"></ol>
            </div>
        </section>

        <br>

        <section>
            <div>
                <label for="achievements">ACHIEVEMENTS</label>
                <input type="text" id="achievements" placeholder="Enter Achievements">
                <button type="button" id="addAchievements">ADD ACHIEVEMENTS</button>
                
                <p>Listed Achievements</p>
                <ol id="achievementList"></ol>
            </div>
        </section>
        
        <br>
        
        <label>PLATFORMS OF THE CANDIDATE</label>
        <br>
        <label for="ed">EDUCATION</label>
        <input type="text" id="ed" name="ed">
        <label for="hc">HEALTHCARE</label>
        <input type="text" id="hc" name="hc">
        <label for="cg">CLEAN GOVERNMENT</label>
        <input type="text" id="cg" name="cg">
        <label for="econ">ECONOMY</label>
        <input type="text" id="econ" name="econ">
        <label for="agri">AGRICULTURE</label>
        <input type="text" id="agri" name="agri">

        <br>

        <button type="submit" id="submit">Submit</button>
        <button type="reset" id="reset">Reset</button>
    </form>

    <script>
        // Replace this with your actual Google Apps Script URL
     //   const scriptURL = 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE';

        // Arrays to store multiple entries
        let education = [];
        let experience = [];
        let achievements = [];

        // Form submission handler
        function submitForm(e) {
    e.preventDefault();
    
    const formData = {
        FirstName: document.getElementById("Fname").value,
        MiddleName: document.getElementById("Mname").value,
        LastName: document.getElementById("Lname").value,
        region: document.getElementById("region").value,
        province: document.getElementById("province").value,
        city: document.getElementById("city").value,
        biography: document.getElementById("biography").value,
        bday: document.getElementById("bday").value,
        Party: document.getElementById("Party").value,
        education: education,  // Array from your education list
        experience: experience,  // Array from experience list
        achievements: achievements,  // Array from achievements list
        ed: document.getElementById("ed").value,
        hc: document.getElementById("hc").value,
        cg: document.getElementById("cg").value,
        econ: document.getElementById("econ").value,
        agri: document.getElementById("agri").value
    };

    fetch("/submitAddCandidate", {
        method: "POST",
        body: JSON.stringify(formData),
        headers: {
            "Content-Type": "application/json"
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.result === "success") {
            alert(`Data saved to Row ${data.row}!`);
            // Reset form and clear lists
            document.getElementById("candidateForm").reset();
            education = [];
            experience = [];
            achievements = [];
            updateEducationList();
            updateExperienceList();
            updateAchievementList();
        } else {
            alert("Error: " + data.message);
        }
    })
    .catch(error => {
        console.error("Error:", error);
        alert("Failed to submit data.");
    });
}

        // Education list management
        document.getElementById("addEducation").addEventListener('click', function() {
            const educationName = document.getElementById('education').value.trim();
            if(educationName && !education.includes(educationName)){
                education.push(educationName);
                document.getElementById('education').value = '';
                updateEducationList();
            }
        });

        function updateEducationList() {
            const educationList = document.getElementById('educationList');
            educationList.innerHTML = '';
            education.forEach(edu => {
                const li = document.createElement('li');
                li.textContent = edu;

                const delBtn = document.createElement('button');
                delBtn.textContent = "Delete";
                delBtn.type = "button";
                delBtn.addEventListener('click', function() {
                    education = education.filter(item => item !== edu);
                    updateEducationList();
                });
                li.appendChild(delBtn);
                educationList.appendChild(li);
            });
        }

        // Experience list management
        document.getElementById("addExperience").addEventListener('click', function() {
            const experienceName = document.getElementById('experience').value.trim();
            if(experienceName && !experience.includes(experienceName)){
                experience.push(experienceName);
                document.getElementById('experience').value = '';
                updateExperienceList();
            }
        });

        function updateExperienceList() {
            const experienceList = document.getElementById('experienceList');
            experienceList.innerHTML = '';
            experience.forEach(exp => {
                const li = document.createElement('li');
                li.textContent = exp;

                const delBtn = document.createElement('button');
                delBtn.textContent = "Delete";
                delBtn.type = "button";
                delBtn.addEventListener('click', function() {
                    experience = experience.filter(item => item !== exp);
                    updateExperienceList();
                });
                li.appendChild(delBtn);
                experienceList.appendChild(li);
            });
        }

        // Achievements list management
        document.getElementById("addAchievements").addEventListener('click', function() {
            const achievementName = document.getElementById('achievements').value.trim();
            if(achievementName && !achievements.includes(achievementName)){
                achievements.push(achievementName);
                document.getElementById('achievements').value = '';
                updateAchievementList();
            }
        });

        function updateAchievementList() {
            const achievementList = document.getElementById('achievementList');
            achievementList.innerHTML = '';
            achievements.forEach(ach => {
                const li = document.createElement('li');
                li.textContent = ach;

                const delBtn = document.createElement('button');
                delBtn.textContent = "Delete";
                delBtn.type = "button";
                delBtn.addEventListener('click', function() {
                    achievements = achievements.filter(item => item !== ach);
                    updateAchievementList();
                });
                li.appendChild(delBtn);
                achievementList.appendChild(li);
            });
        }

        // Region, Province, City Selector
        const apiBaseUrl = "https://psgc.gitlab.io/api/";
        const regionSelect = document.getElementById("region");
        const provinceSelect = document.getElementById("province");
        const citySelect = document.getElementById("city");

        // Fetch regions
        fetch(`${apiBaseUrl}/regions`)
            .then(response => response.json())
            .then(data => {
                data.forEach(region => {
                    const option = document.createElement("option");
                    option.value = region.code; 
                    option.textContent = region.name; 
                    regionSelect.appendChild(option);
                });
            })
            .catch(error => console.error("Error fetching regions:", error));

        // Fetch provinces based on selected region
        regionSelect.addEventListener("change", function () {
            const regionCode = this.value;
            provinceSelect.innerHTML = '<option value="" disabled selected>Select Province</option>';
            citySelect.innerHTML = '<option value="" disabled selected>Select City/Municipality</option>';

            fetch(`${apiBaseUrl}/regions/${regionCode}/provinces`)
                .then(response => response.json())
                .then(data => {
                    data.forEach(province => {
                        const option = document.createElement("option");
                        option.value = province.code; 
                        option.textContent = province.name;
                        provinceSelect.appendChild(option);
                    });
                })
                .catch(error => console.error("Error fetching provinces:", error));
        });

        // Fetch cities based on selected province
        provinceSelect.addEventListener("change", function () {
            const provinceCode = this.value;
            citySelect.innerHTML = '<option value="" disabled selected>Select City/Municipality</option>';

            fetch(`${apiBaseUrl}/provinces/${provinceCode}/cities-municipalities/`)
                .then(response => response.json())
                .then(data => {
                    data.forEach(city => {
                        const option = document.createElement("option");
                        option.value = city.code; 
                        option.textContent = city.name;
                        citySelect.appendChild(option);
                    });
                })
                .catch(error => console.error("Error fetching cities:", error));
        });
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>ADD NEW CANDIDATE</h1>
    <form id="form2" action="" method="post">
        
        <div>
            <lable for="fname">FIRST NAME</lable>
            <input type="text" id="Fname" name="FirstName" required placeholder="Gem Adrian">
            
            <lable for="Mname">MIDDLE NAME</lable>
            <input type="text" id="Mname" name="MiddleName" placeholder="Casimero">
            
            <lable for="Lname">LAST NAME</lable>
            <input type="text" id="Lname" name="LastName" required placeholder="Candaganan">
            
        </div>

        <br>
        
        <section>
            <div id="addressSection">
                <label for="region">REGION</label>
                <select id="region" name="region" required>
                    <option value="" disabled selected>Select Region</option>
                </select>
        
                <br><br>
        
                <label for="province">PROVINCE</label>
                <select id="province" name="province" required>
                    <option value="" disabled selected>Select Province</option>
                </select>
        
                <br><br>
        
                <label for="city">CITY/MUNICIPALITY</label>
                <select id="city" name="city" required>
                    <option value="" disabled selected>Select City/Municipality</option>
                </select>
            </div>
        
            <script>

                const apiBaseUrl = "https://psgc.gitlab.io/api/";
        
                const regionSelect = document.getElementById("region");
                const provinceSelect = document.getElementById("province");
                const citySelect = document.getElementById("city");
        
         
                fetch(`${apiBaseUrl}/regions`)
                    .then(response => response.json())
                    .then(data => {
                        data.forEach(region => {
                            const option = document.createElement("option");
                            option.value = region.code; 
                            option.textContent = region.name; 
                            regionSelect.appendChild(option);
                        });
                    })
                    .catch(error => console.error("Error fetching regions:", error));
        
                // Fetch provinces based on selected region
                regionSelect.addEventListener("change", function () {
                    const regionCode = this.value;
                    provinceSelect.innerHTML = '<option value="" disabled selected>Select Province</option>';
                    citySelect.innerHTML = '<option value="" disabled selected>Select City/Municipality</option>';
        
                    fetch(`${apiBaseUrl}/regions/${regionCode}/provinces`)
                        .then(response => response.json())
                        .then(data => {
                            data.forEach(province => {
                                const option = document.createElement("option");
                                option.value = province.code; 
                                option.textContent = province.name;
                                provinceSelect.appendChild(option);
                            });
                        })
                        .catch(error => console.error("Error fetching provinces:", error));
                });
        
                provinceSelect.addEventListener("change", function () {
                    const provinceCode = this.value;
                    citySelect.innerHTML = '<option value="" disabled selected>Select City/Municipality</option>';
        
                    fetch(`${apiBaseUrl}/provinces/${provinceCode}/cities-municipalities/`)
                        .then(response => response.json())
                        .then(data => {
                            data.forEach(city => {
                                const option = document.createElement("option");
                                option.value = city.code; 
                                option.textContent = city.name;
                                citySelect.appendChild(option);
                            });
                        })
                        .catch(error => console.error("Error fetching cities:", error));
                });
            </script>
        </section>

        <br>
        
        <div>
            <label for="biography">SHORT BIOGRAPHY</label>  
            <textarea id="biography" name="biography" placeholder="Write the candidate's short biogrpahy here"></textarea>
        </div>

        <br>

        <div>
            <label for="Birthday">BIRTHDAY</label>
            <input type="date" id="bday" name="bday" required>
        </div>
        
        <br>

        <div>
            <label for="party">POLITICAL PARTY</label>
            <input type="text" id="party" name="party">
        </div>

        <br>

        <section>
            <div id="educationalBackgroundSection">
                <label for="educBackground">EDUCATIONAL BACKGROUND</label>  
                <input type="text" id="education" name="education[]" placeholder="Enter Educational Background">
                <button type="button" id="addEducation">ADD EDUCATION</button>

                <p>Listed Educational Background</p>
                <ol id="educationList"></ol>
            </div>
            <script>

                let education = [];

                document.getElementById("addEducation").addEventListener('click', function() {
                    const educationName = document.getElementById('education').value;
                    if(educationName){
                        education.push(educationName);
                        document.getElementById('educationList').value = '';
                        updateEducationList();
                    }
        
                    document.getElementById('educationalBackgroundSection').appendChild(newInput);
                });

                function updateEducationList() {
                    const educationList = document.getElementById('educationList');
                    educationList.innerHTML = '';
                    education.forEach(edu => {
                        const li = document.createElement('li');
                        li.textContent = edu;

                        const del = document.createElement('button');
                        del.textContent = "Delete";
                        del.type = "button";
                        del.addEventListener('click', function() {
                            education.splice(education.indexOf(edu), 1);
                            educationList.removeChild(li);
                        });

                        li.appendChild(del);
                        educationList.appendChild(li);
                    });
                }   
            </script>
        </section>
        
        <br>
        
        <section>
            <div id="leadershipExperienceSection">
                <label for="experience">LEADERSHIP EXPERIENCE</label>
                <input type="text" id="experience" name="experience[]" placeholder="Enter Leadership Experience">
                <button type="button" id="addExperience">ADD EXPERIENCES</button>
                
                <p>Listed Leadership Experience</p>
                <ol id="experienceList"></ol>
            </div>
            
            <script>
                let experience = [];

                document.getElementById("addExperience").addEventListener('click', function() {
                    const experienceName = document.getElementById('experience').value;
                    if(experienceName){
                        experience.push(experienceName);
                        document.getElementById('experienceList').value = '';
                        updateExperienceList();
                    }
        
                    document.getElementById('leadershipExperienceSection').appendChild(newInput);
                });

                function updateExperienceList() {
                    const experienceList = document.getElementById('experienceList');
                    experienceList.innerHTML = '';
                    experience.forEach(exp => {
                        const li = document.createElement('li');
                        li.textContent = exp;

                        const del = document.createElement('button');
                        del.textContent = "Delete";
                        del.type = "button";
                        del.addEventListener('click', function() {
                            experience.splice(experience.indexOf(exp), 1);
                            experienceList.removeChild(li);
                        });

                        li.appendChild(del);
                        experienceList.appendChild(li);
                    });
                }
            </script>
        </section>

        <br>

        <section>
            <div>
                <label for="achievements">ACHIEVEMENTS</label>
                <input type="text" id="achievements" name="achievements[]" placeholder="Enter Achievements">
                <button type="button" id="addAchievements" name="button">ADD ACHIEVEMENTS</button>
                
                <p>Listed Achievements</p>
                <ol id="achievementList"></ol>
            </div>

            <script>    
                let achievements = [];

                document.getElementById("addAchievements").addEventListener('click', function() {
                    const achievementName = document.getElementById('achievements').value;
                    if(achievementName){
                        achievements.push(achievementName);
                        document.getElementById('achievementList').value = '';
                        updateAchievementList();
                    }
        
                    document.getElementById('achievements').appendChild(newInput);
                });

                function updateAchievementList() {
                    const achievementList = document.getElementById('achievementList');
                    achievementList.innerHTML = '';
                    achievements.forEach(ach => {
                        const li = document.createElement('li');
                        li.textContent = ach;

                        const del = document.createElement('button');
                        del.textContent = "Delete";
                        del.type = "button";
                        del.addEventListener('click', function() {
                            achievements.splice(achievements.indexOf(ach), 1);
                            achievementList.removeChild(li);
                        });
                        
                        li.appendChild(del);
                        achievementList.appendChild(li);
                    });
                }

            </script>   
        </section>
        
        <br>
        <section id="platformsSection">
            <h2>PLATFORMS</h2>
            <div id="pillarInputsContainer">
                <!-- Dynamic inputs will appear here -->
                <p>Loading pillars...</p>
            </div>
        </section>
        
        <script>
            // Load pillars and create inputs
            async function loadPillarInputs() {
                try {
                    const response = await fetch('/api/pillars');
                    const data = await response.json();
                    
                    const container = document.getElementById('pillarInputsContainer');
                    container.innerHTML = '';
                    
                    if (data.pillars && data.pillars.length > 0) {
                        data.pillars.forEach(pillar => {
                            const div = document.createElement('div');
                            div.className = 'platform-input';
                            
                            const label = document.createElement('label');
                            label.textContent = pillar;
                            label.htmlFor = `platform-${pillar.toLowerCase().replace(/\s+/g, '-')}`;
                            
                            const input = document.createElement('input');
                            input.type = 'text';
                            input.id = `platform-${pillar.toLowerCase().replace(/\s+/g, '-')}`;
                            input.name = `platforms[${pillar}]`;
                            input.placeholder = `Candidate's platform for ${pillar}`;
                            
                            div.appendChild(label);
                            div.appendChild(input);
                            container.appendChild(div);
                        });
                    } else {
                        container.innerHTML = '<p>No pillars defined yet</p>';
                    }
                } catch (error) {
                    console.error("Error loading pillars:", error);
                    document.getElementById('pillarInputsContainer').innerHTML = 
                        '<p>Error loading platform fields</p>';
                }
            }
        
            // Call this when the page loads
            document.addEventListener('DOMContentLoaded', loadPillarInputs);
        </script>

        <br>

        <label for="photo">Upload Candidate's Photo:</label>
        <input type="file" id="photo" name="photo" accept=".jpg, .jpeg" >

        <button type="submit" id="submit">Submit</button>
        <button type="reset" id="reset">Reset</button> 
            
    </form>

</body>
</html>